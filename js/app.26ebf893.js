(function(t){function e(e){for(var i,s,r=e[0],c=e[1],l=e[2],d=0,p=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(p.length)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,r=1;r<n.length;r++){var c=n[r];0!==o[c]&&(i=!1)}i&&(a.splice(e--,1),t=s(s.s=n[0]))}return t}var i={},o={app:0},a=[];function s(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=i,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;a.push([1,"chunk-vendors"]),n()})({0:function(t,e){},1:function(t,e,n){t.exports=n("56d7")},10:function(t,e){},11:function(t,e){},12:function(t,e){},13:function(t,e){},14:function(t,e){},15:function(t,e){},16:function(t,e){},17:function(t,e){},18:function(t,e){},"1a12":function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="1a12"},"1c26":function(t,e,n){var i={"./build":"f885","./build.js":"f885","./clean":"f83a","./clean.js":"f83a","./configure":"8f0e","./configure.js":"8f0e","./info":"53b3","./info.js":"53b3","./install":"3b09","./install.js":"3b09","./node-pre-gyp":"95bb","./node-pre-gyp.js":"95bb","./package":"42e9","./package.js":"42e9","./pre-binding":"c2bf","./pre-binding.js":"c2bf","./publish":"96ac","./publish.js":"96ac","./rebuild":"efb3","./rebuild.js":"efb3","./reinstall":"39b2","./reinstall.js":"39b2","./reveal":"4997","./reveal.js":"4997","./testbinary":"5c9e","./testbinary.js":"5c9e","./testpackage":"4791","./testpackage.js":"4791","./unpublish":"012f","./unpublish.js":"012f","./util/abi_crosswalk":"63e9","./util/abi_crosswalk.json":"63e9","./util/compile":"99ca","./util/compile.js":"99ca","./util/handle_gyp_opts":"b608","./util/handle_gyp_opts.js":"b608","./util/napi":"3d34","./util/napi.js":"3d34","./util/nw-pre-gyp/index.html":"a716","./util/nw-pre-gyp/package":"4ca4","./util/nw-pre-gyp/package.json":"4ca4","./util/s3_setup":"606e","./util/s3_setup.js":"606e","./util/versioning":"f3dc","./util/versioning.js":"f3dc"};function o(t){var e=a(t);return n(e)}function a(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}o.keys=function(){return Object.keys(i)},o.resolve=a,t.exports=o,o.id="1c26"},2:function(t,e){},3:function(t,e){},"3cd6":function(t,e,n){},4:function(t,e){},"42a9":function(t,e,n){"use strict";n("50ad")},"4a26":function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="4a26"},"4a79":function(t,e,n){"use strict";n("d418")},5:function(t,e){},"50ad":function(t,e,n){},"56d1":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"app","element-loading-text":t.loadingText}},[n("options",{attrs:{list:t.contentList,"tmp-list":t.tmpList},on:{submit:t.submit,parse:t.confirmFirstParse,reverse:t.reverseList,"list-update":t.listUpdate,"update-tag":t.updateTag,reset:t.reset}}),n("div",{staticClass:"editor radio flex-v"},[n("selected-text",{attrs:{selected:t.checkedMemo.length,total:t.contentList.length,"import-count":t.importCount,disabled:t.disabled},on:{change:t.checkAllChange}}),n("div",{staticClass:"flex-1 overauto"},[n("draggable",t._b({staticClass:"list-group",attrs:{tag:"ul",disabled:t.dragDisabled},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1}},model:{value:t.contentList,callback:function(e){t.contentList=e},expression:"contentList"}},"draggable",t.dragOptions,!1),[n("transition-group",{attrs:{type:"transition",name:t.drag?null:"flip-list"}},t._l(t.contentList,(function(e,i){return n("content-card",{key:e.text+i,staticClass:"list-group-item",attrs:{input:e.text,check:e.checked,edit:e.isEdit,info:e,disabled:t.disabled},on:{"update:input":function(n){return t.$set(e,"text",n)},"update:check":function(n){return t.$set(e,"checked",n)},"update:edit":function(n){return t.$set(e,"isEdit",n)}}})})),1)],1)],1)],1)],1)},a=[],s=n("ade3"),r=(n("4de4"),n("99af"),n("d81d"),n("ac1f"),n("1276"),n("a15b"),n("bc3a")),c=n.n(r),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"content-card"},[n("div",{staticClass:"checkbox"},[n("label",{staticClass:"label",class:t.disabled?"disabled":""},[n("i",{staticClass:"el-icon-success",class:t.checked?"active":""}),n("el-checkbox",{attrs:{disabled:t.disabled},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}})],1)]),n("div",{staticClass:"priview radio",on:{dblclick:t.handleEdit}},[t.isEdit?[n("el-input",{attrs:{type:"textarea",autosize:"",rows:5},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),n("div",{staticClass:"pt-10 text-right"},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.submit}},[t._v("完成")])],1)]:n("pre",[t._v(t._s(t.content))])],2)])},u=[],d={name:"ContentCard",props:{info:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1}},data:function(){return{content:this.info.text,checked:this.info.checked,isEdit:this.info.isEdit}},watch:{info:{handler:function(t){var e=t.checked,n=t.text,i=t.isEdit;this.content=n,this.checked=e,this.isEdit=i},deep:!0},isEdit:function(t){this.$emit("update:edit",t)},checked:function(t){this.$emit("update:check",t)}},methods:{handleEdit:function(){var t=this,e=localStorage.getItem("canDrag")||"0";"0"===e?this.$alert("有 MEMO 在编辑模式时，列表无法进行拖动排序。","提示",{confirmButtonText:"知道了，不再提示",callback:function(e){localStorage.setItem("canDrag","1"),t.$emit("update:edit",!0)}}):this.$emit("update:edit",!0)},submit:function(){this.$emit("update:edit",!1),this.$emit("update:input",this.content)}}},p=d,f=(n("daba"),n("2877")),h=Object(f["a"])(p,l,u,!1,null,"8e15e820",null),m=h.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"options radio"},[n("div",{staticClass:"top"},[n("el-form",{ref:"form",attrs:{model:t.options,"label-width":"80px",size:"mini","label-suffix":"：","label-position":"top"}},[n("el-form-item",{attrs:{label:"Api"}},[n("el-input",{attrs:{type:"password","show-password":"",placeholder:"API 采用本地存储"},model:{value:t.options.api,callback:function(e){t.$set(t.options,"api",e)},expression:"options.api"}})],1),n("el-form-item",{attrs:{"label-width":"0"}},[n("el-upload",{staticStyle:{width:"100%"},attrs:{id:"fileSelect","show-file-list":!1,multiple:!1,action:"","auto-upload":!1,accept:".html,.txt"}},[n("div",{staticClass:"upload-content radio flex pd-10 border"},[n("i",{staticClass:"el-icon-folder-add"}),n("div",{staticClass:"el-upload__text"},[t._v(" 选择 HTML / TXT 文件 ")])])]),n("div",{staticClass:"how"},[n("i",{staticClass:"el-icon-question"}),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/CPIYoGItJVWJGk30MoVNXA",target:"_blank"}},[t._v("如何导出 HTML？")]),n("el-tooltip",{attrs:{effect:"dark",placement:"right"}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"pb-10"},[t._v(" 将 Kindle 通过数据线连接至电脑 ")]),n("div",[t._v(" 文件位于：Kindle根目录 - document - My Clippings.txt ")])]),n("span",{staticClass:"pointer"},[t._v("My Clippings.txt 在哪？")])])],1)],1),t.isElectron?n("el-form-item",{attrs:{"label-width":"0"}},[n("div",{staticClass:"flex thired-import"},[n("div",{staticClass:"pointer text-center border pd-10 radio flex-item",on:{click:t.importAppleBooks}},[t._v(" Apple Books ")]),n("div",{staticClass:"pointer text-center border pd-10 radio flex-item",on:{click:t.importWeRead}},[t._v(" 微信读书 ")])])]):n("el-form-item",{attrs:{"label-width":"0"}},[n("div",{staticClass:"pointer text-center border pd-10 radio"},[n("el-tooltip",{attrs:{effect:"dark",placement:"right"}},[n("div",{staticStyle:{"line-height":"1.5em"},attrs:{slot:"content"},slot:"content"},[t._v(" 由于 Apple Books 与微信读书笔记的笔记读取方式限制，只能通过安装应用读取。 "),n("br"),n("span",{staticStyle:{color:"#d96767"}},[t._v("下载文件夹下版本号最新的安装包")]),n("br"),t._v(" 文件访问密码：47if ")]),n("a",{attrs:{href:"https://wwr.lanzoui.com/b02c3nkyf",target:"_blank"}},[t._v(" 从 Apple Books / 微信读书 导入 ")])])],1),n("a",{staticClass:"how",attrs:{href:"https://evolly.one/2021/05/30/158-mac-handle-bad-app/",target:"_blank"}},[t._v(" Kindle2Flomo.app 打不开？ ")])]),t.bookList.length?n("el-form-item",{attrs:{label:"选择书籍"}},[n("el-select",{on:{change:t.selectChange},model:{value:t.options.book,callback:function(e){t.$set(t.options,"book",e)},expression:"options.book"}},t._l(t.bookList,(function(t,e){return n("el-option",{key:t.index,attrs:{label:t.title,value:t.title}})})),1)],1):t._e(),n("el-form-item",{attrs:{label:"书名"}},[n("el-input",{attrs:{clearable:""},model:{value:t.options.title,callback:function(e){t.$set(t.options,"title",e)},expression:"options.title"}})],1),n("el-form-item",{attrs:{label:"Tag"}},[n("div",{staticClass:"flex"},[n("div",{staticClass:"flex-1"},[n("el-input",{attrs:{disabled:t.options.noTag,clearable:""},model:{value:t.options.tag,callback:function(e){t.$set(t.options,"tag",e)},expression:"options.tag"}})],1),n("div",{staticClass:"flex-1 pl-10"},[n("el-checkbox",{model:{value:t.options.noTag,callback:function(e){t.$set(t.options,"noTag",e)},expression:"options.noTag"}},[t._v("隐藏 tag")])],1)])]),t.options.noTag?t._e():[n("el-form-item",{attrs:{label:"Tag 位置"}},[n("el-switch",{attrs:{"active-text":"顶部","inactive-text":"底部"},model:{value:t.options.tagPosition,callback:function(e){t.$set(t.options,"tagPosition",e)},expression:"options.tagPosition"}})],1)],n("el-form-item",{attrs:{label:""}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"left"}},[n("div",{staticStyle:{width:"200px","line-height":"1.5em"},attrs:{slot:"content"},slot:"content"},[t._v(" 如导入内容含有自己添加的笔记，请使用移动端 APP 导出 HTML 或 My Clippings.txt ")]),n("i",{staticClass:"el-icon-warning"})]),t._v(" 笔记位置： ")],1),n("el-switch",{attrs:{"active-text":"摘录上方","inactive-text":"摘录下方"},model:{value:t.options.notePosition,callback:function(e){t.$set(t.options,"notePosition",e)},expression:"options.notePosition"}})],1),n("el-form-item",{attrs:{label:"分隔符"}},[n("el-input",{attrs:{placeholder:"为空以空行填充，此空行无法禁用",clearable:""},model:{value:t.options.split,callback:function(e){t.$set(t.options,"split",e)},expression:"options.split"}}),n("span",{staticClass:"fz-12"},[t._v("分隔符"),n("b",{staticClass:"highlight"},[t._v("仅在有笔记时生效")]),t._v("，且总在笔记与摘录之间")])],1),n("el-form-item",{attrs:{label:"空行设置"}},[n("div",{staticClass:"flex"},[n("div",{staticClass:"flex-1 pl-10"},[n("el-checkbox",{on:{change:t.onlyTagChange},model:{value:t.options.onlyTag,callback:function(e){t.$set(t.options,"onlyTag",e)},expression:"options.onlyTag"}},[t._v("仅 Tag 前 / 后")])],1),n("div",{staticClass:"flex-1 pl-10"},[n("el-checkbox",{attrs:{disabled:t.options.onlyTag},model:{value:t.options.noEmptyLine,callback:function(e){t.$set(t.options,"noEmptyLine",e)},expression:"options.noEmptyLine"}},[t._v("禁用")])],1)])]),n("el-form-item",{attrs:{label:"列表顺序"}},[n("el-switch",{attrs:{"active-text":"倒序","inactive-text":"顺序"},on:{change:t.reverse},model:{value:t.options.reverse,callback:function(e){t.$set(t.options,"reverse",e)},expression:"options.reverse"}})],1)],2)],1),n("div",{staticClass:"bottom"},[n("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.tmpList.length},on:{click:t.parse}},[t._v("解析")]),n("el-button",{attrs:{type:"primary",disabled:t.disabledSend,size:"mini"},on:{click:t.submit}},[t._v("导入 Flomo")])],1),n("el-dialog",{staticClass:"login-dialog",attrs:{visible:t.showDialog,width:"270px"},on:{"update:visible":function(e){t.showDialog=e}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"iframe-box"},[t.showDialog?n("iframe",{attrs:{src:"https://weread.qq.com/#login",frameborder:"0"}}):t._e()])])],1)},g=[],v=n("5530"),k=n("2909"),x=n("3835"),y=(n("7db0"),n("d3b7"),n("3ca3"),n("ddb0"),n("b0c0"),n("5319"),n("498a"),n("a630"),n("53ca"));n("159b"),n("c740");function T(t){var e=Object(y["a"])(t);return"function"===e||"object"===e&&!!t}function _(t){if(!T(t))return t;for(var e,n,i=1,o=arguments.length;i<o;i++)for(n in e=arguments[i],e)t[n]=e[n];return t}function w(t){return-1!==t.indexOf("标注")?1:-1!==t.indexOf("笔记")||-1!==t.indexOf("书签")?2:void 0}var O={split_created:function(t){t=t.split("|").map((function(t){return t.trim()}));try{var e=/添加于\s+(\d{4})年(\d+)月(\d+)日.*(上|下)午(\d+):(\d+):(\d+)$/,n=e.exec(t[1]),i=+n[5],o="上"===n[4]?i:i+12===24?0:i+12,a=n[6],s=n[7],r=t[0].substr(2),c=r.replace(/[^0-9]/gi,""),l=w(r);return{type:l,position:1===l?r:c,note:"",date:new Date(n[1]+" "+n[2]+" "+n[3]+" "+o+":"+a+":"+s)}}catch(u){return{note:"",position:"",date:""}}},split_book:function(t){t=t.replace(/（/g,"(").replace(/）/g,")");try{var e=/(.+)\((.+)\)/,n=e.exec(t);return{book:n[1].trim(),author:n[2].trim()}}catch(i){console.log(i)}}};function C(t){this.position="",this.book="",this.author="",this.date=null,this.content="",this.texts=t,this.type="",this.init()}function E(t){t=t.split("==========").filter((function(t){return t}));var e=[],n=[];t.map(L).forEach((function(t){t&&(1===t.type&&t.content&&n.push(t),2===t.type&&t.content&&e.push(t))})),e.forEach((function(t){var e=n.findIndex((function(e){return-1!==e.position.indexOf(t.position)}));-1!==e&&(n[e].note=t.content)}));var i=[];return n.forEach((function(t){var e=i.findIndex((function(e){return e.title===t.book}));-1!==e?i[e].texts.push({text:t.content,note:t.note,checked:!1,isEdit:!1}):i.push({title:t.book,texts:[{text:t.content,note:t.note,checked:!1,isEdit:!1}]})})),i.reverse()}function L(t){return t=t.trim(),t?new C(t):null}C.prototype.init=function(){var t=this.texts.split("\r\n").filter((function(t){return t})),e=null;e=O.split_book(t[0]),_(this,e),t[1]&&(e=O.split_created(t[1]),_(this,e)),this.content=t[2],e=null};var N=E,j=n("1431");function A(t){var e=t.replace(/(?<=\>[^<]*?) /g,"").replace(/\n|\r/g,""),n=j.load(e);n("h3.noteHeading").length&&(e=e.replace(/<\/h3>/g,"</div>").replace(/<\/div><div class='noteText'>/g,"</h3><div class='noteText'>"),n=j.load(e));var i=n(".bookTitle")[0],o=n(i).text().trim(),a=[],s=Array.from(n(".noteText")),r=[];while(s.length){var c=s.pop(),l=w(c.prev.children[0].data),u=c.children.filter((function(t){return"text"===t.type})).map((function(t){return t.data.trim()})).join("");2===l&&r.push(u),1===l&&a.unshift({text:u,note:r.pop()||"",checked:!1,isEdit:!1})}return{title:o,texts:a}}var I=A,S=n("1da1"),D=(n("96cf"),n("fb6a"),{}),M={},$={},P=function(){},B=function(){return Promise.resolve([])};Object({VUE_APP_CLI_UI_URL:"",NODE_ENV:"production",BASE_URL:""}).IS_ELECTRON&&(D=n("3e8f"),M=n("3c43"),$=n("7781"),P=n("c7b3").db,B=function(){var t=M.homedir(),e="/Library/Containers/com.apple.iBooksX/Data/Documents/AEAnnotation/",n="";try{n=D.readdirSync("".concat(t).concat(e))}catch(a){return Promise.reject("未发现笔记文件")}var i=n.find((function(t){return"sqlite"===t.slice(-6).toLowerCase()}));if(!i)return Promise.reject("未发现笔记文件");var o=P("".concat(t).concat(e),i);return new Promise((function(e,n){o.all("\n          SELECT\n              ZANNOTATIONREPRESENTATIVETEXT as BroaderText,\n              ZANNOTATIONSELECTEDTEXT as SelectedText,\n              ZANNOTATIONNOTE as Note,\n              ZFUTUREPROOFING5 as Chapter,\n              ZANNOTATIONCREATIONDATE as Created,\n              ZANNOTATIONMODIFICATIONDATE as Modified,\n              ZANNOTATIONASSETID\n          FROM ZAEANNOTATION\n          WHERE ZANNOTATIONSELECTEDTEXT IS NOT NULL\n          ORDER BY ZANNOTATIONASSETID ASC\n        ",function(){var i=Object(S["a"])(regeneratorRuntime.mark((function i(o,s){var r,c,l,u;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(o){i.next=20;break}return r="".concat(t,"/Library/Containers/com.apple.BKAgentService/Data/Documents/iBooks/Books/Books.plist"),c={},l=[],i.prev=4,i.next=7,$.parseFile(r);case 7:u=i.sent,c=u[0],l=c.Books,i.next=16;break;case 12:i.prev=12,i.t0=i["catch"](4),console.log(i.t0),n("图书列表解析出错");case 16:try{s.forEach((function(t){var e=l.findIndex((function(e){return e.BKGeneratedItemId===t.ZANNOTATIONASSETID}));if(e>=0){var n={text:t.SelectedText,note:t.Note,checked:!1,isEdit:!1};try{l[e].texts.push(n)}catch(a){l[e].texts=[],l[e].texts.push(n)}}}))}catch(a){console.log(a)}e(l.filter((function(t){return t.texts})).map((function(t){return{title:t.BKDisplayName,texts:t.texts}}))),i.next=21;break;case 20:n("笔记解析出错");case 21:case"end":return i.stop()}}),i,null,[[4,12]])})));return function(t,e){return i.apply(this,arguments)}}())}))});var q=B,U=n("5c96"),F=n.n(U);n("a9e3");function R(t){var e;return t.split(";").forEach((function(t){var n=t.trim().split("="),i=Object(x["a"])(n,2),o=i[0],a=i[1];"wr_vid"===o&&(e=Number(a))})),e}c.a.defaults.baseURL="https://i.weread.qq.com";var z={Host:"i.weread.qq.com",Connection:"keep-alive","Upgrade-Insecure-Requests":1,"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3","Accept-Encoding":"gzip, deflate, br","Accept-Language":"zh-CN,zh;q=0.9,en;q=0.8"};c.a.interceptors.request.use((function(t){return Object(v["a"])(Object(v["a"])({},t),{},{headers:z})}),(function(t){return Promise.reject(t)})),c.a.interceptors.response.use((function(t){return t.data}),(function(t){var e=t.response;if(e)return console.log(e.statusText,e.data&&e.data.errmsg),Promise.reject(e.data);console.log("something wrong")}));var Z=function(t){return c()({method:"get",url:"/book/bookmarklist",params:{bookId:t}})},J=function(t){return c()({method:"get",url:"/shelf/friendCommon",params:{userVid:R(t)}})},V=function(t,e){return c()({method:"get",url:"/web/review/list",baseURL:"https://weread.qq.com",params:Object(v["a"])({userVid:R(e)},t)})};function G(t){return new Promise((function(e,n){J(t).then((function(t){var n=t.recentBooks.map((function(t){return{title:t.title,loaded:!1,bookId:t.bookId,texts:[]}}));e(n)})).catch((function(t){n(t)}))}))}function H(t){return new Promise((function(e,n){Z(t).then((function(t){var n=t.updated.map((function(t){return{text:t.markText,note:"",checked:!1,isEdit:!1}}));e(n)})).catch((function(t){n(t)}))}))}function K(t,e){return new Promise((function(n,i){V(t,e).then((function(t){var e=t.reviews.map((function(t){return{text:t.review.abstract,note:t.review.content||"",checked:!1,isEdit:!1}}));n(e)})).catch((function(t){i(t)}))}))}var W={name:"Options",props:{list:{type:Array,default:function(){return[]}},tmpList:{type:Array,default:function(){return[]}}},data:function(){return{options:{book:"",title:"",split:"",tag:"kindle",api:"",noTag:!1,reverse:!1,tagPosition:!1,notePosition:!1,noEmptyLine:!0,onlyTag:!1},tag:"",bookList:[],isElectron:!!Object({VUE_APP_CLI_UI_URL:"",NODE_ENV:"production",BASE_URL:""}).IS_ELECTRON,showDialog:!1,cookie:null,loading:!1,logout:!1,firstLoad:!1}},watch:{options:{handler:function(){this.computedTag()},deep:!0,immediate:!0}},computed:{checkedMemo:function(){return this.list.filter((function(t){return t.checked}))},disabledSend:function(){return!this.checkedMemo.length||!this.options.api}},created:function(){this.setOptions()},mounted:function(){var t=this;this.$nextTick((function(){t.listenFile()}))},methods:{onlyTagChange:function(t){t&&(this.options.noEmptyLine=!0)},importWeRead:function(){var t=this;this.loading=!0,this.showDialog=!0;var e=n("bdb9").remote.session,i={urls:["https://weread.qq.com/*"]};e.defaultSession.webRequest.onBeforeSendHeaders(i,(function(e,n){if(!t.firstLoad){var i=e.requestHeaders.Cookie;t.cookie=i,t.logout?t.loading=!1:G(i).then((function(e){t.firstLoad=!0,t.showDialog=!1,t.loading=!1,t.handleBooksData(e)})).catch((function(e){var n=e.errmsg;t.loading=!1,t.firstLoad=!1,"登录超时"===n&&(t.logout=!0,window.location.reload())}))}n(e)}))},importAppleBooks:function(){var t=this,e=U["Loading"].service({body:!0,lock:!0,text:"正在读取笔记"});q().then((function(n){try{setTimeout((function(){t.handleBooksData(n),e.close()}),1500)}catch(i){e.close()}})).catch((function(n){t.$message.error(n),e.close()}))},handleBooksData:function(t){this.bookList=t;var e=t[0];e.bookId&&this.selectChange(e.title),this.options.book=e.title,this.updateData(e)},selectChange:function(t){var e=this,n=this.bookList.find((function(e){return e.title===t}));if(n.bookId&&!n.loaded){var i=K({bookId:n.bookId,listType:11,maxIdx:0,count:0,listMode:2,synckey:0,mine:1},this.cookie),o=H(n.bookId);Promise.all([i,o]).then((function(t){var i=Object(x["a"])(t,2),o=i[0],a=i[1];n.texts=[].concat(Object(k["a"])(o),Object(k["a"])(a)),n.loaded=!0,e.updateData(n)})).catch((function(t){console.log(t)}))}else this.updateData(n)},parse:function(){this.updateOptions(),this.$emit("parse",this.options)},submit:function(){this.$emit("submit",this.options.api)},reverse:function(){this.$emit("reverse")},setOptions:function(){var t=JSON.parse(localStorage.getItem("options"));this.$set(this,"options",Object(v["a"])(Object(v["a"])({},this.options),t))},reset:function(){this.bookList=[],this.$emit("reset")},listenFile:function(){var t=this;document.querySelector("#fileSelect input").addEventListener("change",(function(e){t.reset(),t.$nextTick((function(){var n=e.target.files[0],i=n.name.split(".").pop().toLowerCase(),o=new FileReader;o.onload=function(){if("txt"===i){t.bookList=N(o.result);try{var e=t.bookList[0];t.options.book=e.title,t.updateData(e)}catch(a){}}if("html"===i){var n=I(o.result);t.updateData(n)}},o.readAsText(n)}))}))},updateData:function(t){var e=t.title,n=t.texts,i=t.bookId;this.options.title=e,this.$emit("list-update",n),n.length||i?this.parse():this.$message.warning("未发现有效内容")},updateOptions:function(){var t=this.options,e=t.noTag,n=t.api,i=t.tag,o=t.split,a=t.tagPosition,s=t.reverse,r=t.noEmptyLine,c=t.onlyTag,l={noTag:e,api:n,tag:i,split:o,tagPosition:a,reverse:s,noEmptyLine:r,onlyTag:c};localStorage.setItem("options",JSON.stringify(l))},computedTag:function(){var t="",e=this.options,n=e.tag,i=e.title,o=e.noTag;if(o)return this.$emit("update-tag",t),this.tag=t,!1;t=n?"#".concat(n,"/").concat(i):"#".concat(i),this.$emit("update-tag",t),this.tag=t}}},X=W,Y=(n("4a79"),Object(f["a"])(X,b,g,!1,null,"3d35deba",null)),Q=Y.exports,tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"selected-text radio flex"},[n("el-tooltip",{attrs:{effect:"dark",placement:"left"}},[n("div",{staticStyle:{width:"200px","line-height":"1.5em"},attrs:{slot:"content"},slot:"content"},[t._v(" 未经审视的生活不值得过，未经审视的思想也不应该汇入你的大脑。建议在导入前审视一遍内容。 ")]),n("div",{staticClass:"checkbox"},[n("label",{staticClass:"label",class:t.disabled?"disabled":""},[n("i",{staticClass:"el-icon-success",class:t.checkAll?"active":""}),n("el-checkbox",{attrs:{disabled:t.disabled},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}})],1)])]),n("div",{staticClass:"flex-1 flex"},[t._v(" 已选择 "),n("span",{staticClass:"highlight"},[t._v(t._s(t.selected))]),t._v(" 条 MEMO，共 "),n("span",{staticClass:"highlight"},[t._v(t._s(t.total))]),t._v(" 条。今天已导入 "),n("span",{staticClass:"highlight"},[t._v(t._s(t.importCount)+" / 100")]),t._v(" 条 MEMO "),n("a",{staticClass:"thanks",attrs:{href:"https://mp.weixin.qq.com/s/o793lUsBaWc61fLZzFDlxg",target:"_blank"}},[t._v(" 感谢 LP 的授权 ")]),n("div",{staticClass:"pl-10 pointer"},[n("el-tooltip",{attrs:{effect:"dark",content:"发送邮件至：evollyone@outlook.com",placement:"bottom"}},[n("img",{attrs:{slot:"content",width:"200px",height:"200px",src:"https://gblobscdn.gitbook.com/assets%2F-MVEe4qiW5TBO3wosktr%2F-McqOyO9scmhvjxOKjqy%2F-McqT6ENIJnzZEGJhoeX%2F%E5%9B%BE%E7%89%87.png?alt=media&token=a1a523d4-f926-4615-b1de-b6fced4c46ab",alt:"",srcset:""},slot:"content"}),n("span",{staticStyle:{color:"#d96767"}},[t._v(" 有问题？ ")])])],1)]),n("div",[n("el-dropdown",[n("span",[t._v(" 关于作者 ")]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",[n("a",{attrs:{href:"https://evolly.one",target:"_blank"}},[t._v("博客")])]),n("el-dropdown-item",[n("a",{attrs:{href:"https://album.animalcrossing.life",target:"_blank"}},[t._v("Tit1e's Photo Studio")])]),n("el-dropdown-item",[n("a",{attrs:{href:"https://personal-1251959693.cos.ap-chengdu.myqcloud.com/2021-05-23-IMG_8849.PNG",target:"_blank"}},[n("img",{attrs:{src:"https://personal-1251959693.cos.ap-chengdu.myqcloud.com/2021-05-23-IMG_8849.PNG",width:"200px",alt:"即刻"}})])])],1)],1)],1)],1)},et=[],nt={name:"SelectedText",props:{selected:{type:Number,default:0},total:{type:Number,default:0},disabled:{type:Boolean,default:!1},importCount:{type:Number,default:0}},data:function(){return{checkAll:!1}},watch:{checkAll:function(t){this.$emit("change",t)}},methods:{}},it=nt,ot=(n("42a9"),Object(f["a"])(it,tt,et,!1,null,"00ecc860",null)),at=ot.exports,st=n("b76a"),rt=n.n(st),ct={name:"app",components:{ContentCard:m,Options:Q,SelectedText:at,draggable:rt.a},filters:{},data:function(){return{date:"",contentList:[],tmpList:[],index:0,loading:!1,tag:"",drag:!1,dragOptions:{animation:200},importCount:0}},watch:{importCount:function(t){localStorage.setItem("importCount",JSON.stringify(Object(s["a"])({},this.date,t)))}},computed:{dragDisabled:function(){return!!this.contentList.filter((function(t){return t.isEdit})).length},disabled:function(){return this.checkedMemo.length>=100},checkedMemo:function(){return this.contentList.filter((function(t){return t.checked}))},loadingText:function(){return"为减轻服务器压力，导入间隔为 1s。导入进度： ".concat(this.index+1,"/").concat(this.checkedMemo.length)}},created:function(){this.date=this.setDate(),this.geImportCount(this.date)},methods:{checkAllChange:function(t){this.contentList=this.contentList.map((function(e,n){return t&&n<=99?(e.checked=!0,e):(e.checked=!1,e)}))},updateTag:function(t){this.tag=t},listUpdate:function(t){this.tmpList=t},sendMemo:function(t,e,n){var i=this,o={content:e[n].text};c.a.post(t,o).then((function(o){i.importCount+=1,n<e.length-1?setTimeout((function(){i.index+=1,i.sendMemo(t,e,i.index)}),1e3):(i.$message.success("导入完毕"),i.loading=!1)})).catch((function(t){console.error(t),i.loading=!1,i.$message.error("记录失败")}))},submit:function(t){this.loading=!0,this.index=0,this.sendMemo(t,this.checkedMemo,this.index)},confirmCanEdit:function(t){var e=this,n=localStorage.getItem("canEdit")||"0";"0"===n&&this.$alert("双击 MEMO 可进入编辑模式","提示",{confirmButtonText:"知道了，不再提示",callback:function(n){localStorage.setItem("canEdit","1"),e.parse(t)}})},confirmFirstParse:function(t){var e=this,n=localStorage.getItem("hasConfirm")||"0";"0"===n?this.$alert("每次修改“书名”、“Tag”、“Tag 位置”、“分隔符”后需重新解析才会生效，重新解析会还原编辑后的内容。","提示",{confirmButtonText:"知道了，不再提示",callback:function(n){localStorage.setItem("hasConfirm","1"),e.parse(t)}}):this.parse(t)},parse:function(t){var e=this,n=t.split,i=t.tagPosition,o=t.notePosition,a=t.noEmptyLine,s=t.onlyTag,r=t.noTag;this.contentList=[],this.$nextTick((function(){e.contentList=JSON.parse(JSON.stringify(e.tmpList)).map((function(t){var c="".concat(t.text,"\r\n"),l=t.note?"".concat(n).concat(n||a?"\r\n":""):"",u=t.note?[c,l,"".concat(t.note,"\r\n")]:[c,l];o&&u.reverse();var d=u.filter((function(t){return t})).join(a?"":"\r\n");return r||(i?d="".concat(e.tag,s?"\r\n\r\n":a?"\r\n":"\r\n\r\n")+d:d+=s?"\r\n".concat(e.tag):a?e.tag:"\r\n".concat(e.tag)),t.text=d,t})),e.confirmCanEdit(t)}))},reverseList:function(){this.contentList.reverse()},reset:function(){this.contentList=[],this.tmpList=[]},setDate:function(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return"".concat(e).concat(n).concat(i)},geImportCount:function(t){var e=JSON.parse(localStorage.getItem("importCount")||"{}");this.importCount=+e[t]||0}}},lt=ct,ut=(n("abb8"),Object(f["a"])(lt,o,a,!1,null,null,null)),dt=ut.exports;n("0fae");i["default"].use(F.a);n("3cd6"),n("9536");i["default"].config.productionTip=!1,i["default"].prototype.$EventBus=new i["default"],new i["default"]({render:function(t){return t(dt)}}).$mount("#app")},"5b9d":function(t,e,n){var i={"./Find-VS2017.cs":"c3f6","./build":"c22b","./build.js":"c22b","./clean":"1910","./clean.js":"1910","./configure":"c0a3","./configure.js":"c0a3","./find-node-directory":"3265","./find-node-directory.js":"3265","./find-vs2017":"d3f3","./find-vs2017.js":"d3f3","./install":"1eed","./install.js":"1eed","./list":"7777","./list.js":"7777","./node-gyp":"a9a0","./node-gyp.js":"a9a0","./process-release":"4e82","./process-release.js":"4e82","./rebuild":"626c","./rebuild.js":"626c","./remove":"bcf9","./remove.js":"bcf9"};function o(t){var e=a(t);return n(e)}function a(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}o.keys=function(){return Object.keys(i)},o.resolve=a,t.exports=o,o.id="5b9d"},6:function(t,e){},"623a":function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="623a"},7:function(t,e){},8:function(t,e){},9:function(t,e){},9536:function(t,e,n){},abb8:function(t,e,n){"use strict";n("56d1")},c7b3:function(t,e,n){n("a15b");var i=n("fc0d").verbose(),o=n("df7c"),a=function(t,e){return new i.Database(o.join(t,e))};t.exports={db:a}},d418:function(t,e,n){},daba:function(t,e,n){"use strict";n("e4ca")},e4ca:function(t,e,n){}});
//# sourceMappingURL=app.26ebf893.js.map