(function(t){function e(e){for(var n,a,r=e[0],c=e[1],l=e[2],d=0,p=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],n=!0,r=1;r<i.length;r++){var c=i[r];0!==o[c]&&(n=!1)}n&&(s.splice(e--,1),t=a(a.s=i[0]))}return t}var n={},o={app:0},s=[];function a(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=n,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0eb6":function(t,e,i){},"3ae5":function(t,e,i){},"3cd6":function(t,e,i){},"56d1":function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"app","element-loading-text":t.loadingText}},[i("options",{attrs:{list:t.contentList,"tmp-list":t.tmpList},on:{submit:t.submit,parse:t.confirmFirstParse,reverse:t.reverseList,"list-update":t.listUpdate,"update-tag":t.updateTag,reset:t.reset}}),i("div",{staticClass:"editor radio flex-v"},[i("selected-text",{attrs:{selected:t.checkedMemo.length,total:t.contentList.length}}),i("div",[i("draggable",t._b({staticClass:"list-group",attrs:{tag:"ul",disabled:t.dragDisabled},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1}},model:{value:t.contentList,callback:function(e){t.contentList=e},expression:"contentList"}},"draggable",t.dragOptions,!1),[i("transition-group",{attrs:{type:"transition",name:t.drag?null:"flip-list"}},t._l(t.contentList,(function(e,n){return i("content-card",{key:e.text,staticClass:"list-group-item",attrs:{input:e.text,check:e.checked,edit:e.isEdit,info:e,disabled:t.disabled},on:{"update:input":function(i){return t.$set(e,"text",i)},"update:check":function(i){return t.$set(e,"checked",i)},"update:edit":function(i){return t.$set(e,"isEdit",i)}}})})),1)],1)],1)],1)],1)},s=[],a=(i("4de4"),i("99af"),i("ac1f"),i("1276"),i("d81d"),i("6829")),r=i.n(a),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"content-card"},[i("div",{staticClass:"checkbox"},[i("label",{staticClass:"label",class:t.disabled?"disabled":""},[i("i",{staticClass:"el-icon-success",class:t.checked?"active":""}),i("el-checkbox",{attrs:{disabled:t.disabled},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}})],1)]),i("div",{staticClass:"priview radio",on:{dblclick:t.handleEdit}},[t.isEdit?[i("el-input",{attrs:{type:"textarea",autosize:"",rows:5},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),i("div",{staticClass:"pt-10 text-right"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.submit}},[t._v("完成")])],1)]:i("pre",[t._v(t._s(t.content))])],2)])},l=[],u={name:"ContentCard",props:{info:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1}},data:function(){return{content:this.info.text,checked:this.info.checked,isEdit:this.info.isEdit}},watch:{info:{handler:function(t){var e=t.checked,i=t.text,n=t.isEdit;this.content=i,this.checked=e,this.isEdit=n},deep:!0},isEdit:function(t){this.$emit("update:edit",t)},checked:function(t){this.$emit("update:check",t)}},methods:{handleEdit:function(){var t=this,e=localStorage.getItem("canDrag")||"0";"0"===e?this.$alert("有 MEMO 在编辑模式时，列表无法进行拖动排序。","提示",{confirmButtonText:"知道了，不再提示",callback:function(e){localStorage.setItem("canDrag","1"),t.$emit("update:edit",!0)}}):this.$emit("update:edit",!0)},submit:function(){this.$emit("update:edit",!1),this.$emit("update:input",this.content)}}},d=u,p=(i("daba"),i("2877")),f=Object(p["a"])(d,c,l,!1,null,"8e15e820",null),h=f.exports,m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"options radio"},[i("div",{staticClass:"top"},[i("el-form",{ref:"form",attrs:{model:t.options,"label-width":"80px",size:"mini","label-suffix":"：","label-position":"top"}},[i("el-form-item",{attrs:{label:"Api"}},[i("el-input",{attrs:{type:"password","show-password":"",placeholder:"API 采用本地存储"},model:{value:t.options.api,callback:function(e){t.$set(t.options,"api",e)},expression:"options.api"}})],1),i("el-form-item",{attrs:{"label-width":"0"}},[i("el-upload",{staticStyle:{width:"100%"},attrs:{id:"fileSelect","show-file-list":!1,multiple:!1,action:"","auto-upload":!1,accept:".html,.txt"}},[i("div",{staticClass:"upload-content radio flex pd-10"},[i("i",{staticClass:"el-icon-folder-add"}),i("div",{staticClass:"el-upload__text"},[t._v(" 选择 HTML / TXT 文件 ")])])]),i("div",{staticClass:"how"},[i("i",{staticClass:"el-icon-question"}),i("a",{attrs:{href:"https://mp.weixin.qq.com/s/CPIYoGItJVWJGk30MoVNXA",target:"_blank"}},[t._v("如何导出 HTML？")]),i("el-tooltip",{attrs:{effect:"dark",placement:"bottom"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("div",{staticClass:"pb-10"},[t._v(" 将 Kindle 通过数据线连接至电脑 ")]),i("div",[t._v(" 文件位于：Kindle根目录 - document - My Clippings.txt ")])]),i("span",[t._v("My Clippings.txt 在哪？")])])],1)],1),t.bookList.length?i("el-form-item",{attrs:{label:"选择书籍"}},[i("el-select",{on:{change:t.selectChange},model:{value:t.options.book,callback:function(e){t.$set(t.options,"book",e)},expression:"options.book"}},t._l(t.bookList,(function(t,e){return i("el-option",{key:t.index,attrs:{label:t.title,value:t.title}})})),1)],1):t._e(),i("el-form-item",{attrs:{label:"书名"}},[i("el-input",{attrs:{clearable:""},model:{value:t.options.title,callback:function(e){t.$set(t.options,"title",e)},expression:"options.title"}})],1),i("el-form-item",{attrs:{label:"Tag"}},[i("div",{staticClass:"flex"},[i("div",{staticClass:"flex-1"},[i("el-input",{attrs:{disabled:t.options.noTag,clearable:""},model:{value:t.options.tag,callback:function(e){t.$set(t.options,"tag",e)},expression:"options.tag"}})],1),i("div",{staticClass:"flex-1 pl-10"},[i("el-checkbox",{model:{value:t.options.noTag,callback:function(e){t.$set(t.options,"noTag",e)},expression:"options.noTag"}},[t._v("隐藏 tag")])],1)])]),t.options.noTag?t._e():[i("el-form-item",{attrs:{label:"Tag 位置"}},[i("el-switch",{attrs:{"active-text":"顶部","inactive-text":"底部"},model:{value:t.options.tagPosition,callback:function(e){t.$set(t.options,"tagPosition",e)},expression:"options.tagPosition"}})],1),i("el-form-item",{attrs:{label:"tag 示例"}},[i("el-tag",{attrs:{size:"small"}},[t._v(" "+t._s(t.tag)+" ")])],1)],i("el-form-item",{attrs:{label:"分隔符"}},[i("el-input",{attrs:{clearable:""},model:{value:t.options.split,callback:function(e){t.$set(t.options,"split",e)},expression:"options.split"}})],1),i("el-form-item",{attrs:{label:"列表顺序"}},[i("el-switch",{attrs:{"active-text":"倒序","inactive-text":"顺序"},on:{change:t.reverse},model:{value:t.options.reverse,callback:function(e){t.$set(t.options,"reverse",e)},expression:"options.reverse"}})],1)],2)],1),i("div",{staticClass:"bottom"},[i("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.tmpList.length},on:{click:t.parse}},[t._v("解析")]),i("el-button",{attrs:{type:"primary",disabled:t.disabledSend,size:"mini"},on:{click:t.submit}},[t._v("导入 Flomo")])],1)])},g=[],b=i("5530"),v=(i("7db0"),i("b0c0"),i("498a"),i("a15b"),i("1431"));function x(t){var e=v.load(t),i=e(".bookTitle")[0],n=e(i).text().trim(),o=[],s=e(".noteText");return s.each((function(t,e){var i=e.children.filter((function(t){return"text"===t.type})).map((function(t){return t.data.trim()})).join("");o.push({text:i,checked:!1,isEdit:!1})})),{title:n,texts:o}}var k=x,_=i("53ca");i("5319"),i("159b"),i("c740");function y(t){var e=Object(_["a"])(t);return"function"===e||"object"===e&&!!t}function w(t){if(!y(t))return t;for(var e,i,n=1,o=arguments.length;n<o;n++)for(i in e=arguments[n],e)t[i]=e[i];return t}var C={split_created:function(t){t=t.split("|").map((function(t){return t.trim()}));try{var e=/添加于\s+(\d{4})年(\d+)月(\d+)日.*(上|下)午(\d+):(\d+):(\d+)$/,i=e.exec(t[1]),n=+i[5],o="上"===i[4]?n:n+12===24?0:n+12,s=i[6],a=i[7];return{position:t[0].substr(2),date:new Date(i[1]+" "+i[2]+" "+i[3]+" "+o+":"+s+":"+a)}}catch(r){return{position:"",date:""}}},split_book:function(t){t=t.replace(/（/g,"(").replace(/）/g,")");try{var e=/(.+)\((.+)\)/,i=e.exec(t);return{book:i[1].trim(),author:i[2].trim()}}catch(n){console.log(n)}}};function $(t){this.position="",this.book="",this.author="",this.date=null,this.content="",this.texts=t,this.init()}function T(t){t=t.split("==========").filter((function(t){return t}));var e=t.map(L).filter((function(t){return t})),i=[];return e.forEach((function(t){var e=i.findIndex((function(e){return e.title===t.book}));-1!==e?i[e].texts.push({text:t.content,checked:!1,isEdit:!1}):i.push({title:t.book,texts:[{text:t.content,checked:!1,isEdit:!1}]})})),i.reverse()}function L(t){return t=t.trim(),t?new $(t):null}$.prototype.init=function(){var t=this.texts.split("\r\n").filter((function(t){return t})),e=null;e=C.split_book(t[0]),w(this,e),t[1]&&(e=C.split_created(t[1]),w(this,e)),this.content=t[2],e=null};var O=T,M={name:"Options",props:{list:{type:Array,default:function(){return[]}},tmpList:{type:Array,default:function(){return[]}}},data:function(){return{options:{book:"",title:"",split:"",tag:"kindle",api:"",noTag:!1,reverse:!1,tagPosition:!1},tag:"",bookList:[]}},watch:{options:{handler:function(){this.computedTag()},deep:!0,immediate:!0}},computed:{checkedMemo:function(){return this.list.filter((function(t){return t.checked}))},disabledSend:function(){return!this.checkedMemo.length||!this.options.api}},created:function(){this.setOptions()},mounted:function(){var t=this;this.$nextTick((function(){t.listenFile()}))},methods:{selectChange:function(t){var e=this.bookList.find((function(e){return e.title===t}));this.updateData(e)},parse:function(){this.updateOptions(),this.$emit("parse",this.options)},submit:function(){this.$emit("submit",this.options.api)},reverse:function(){this.$emit("reverse")},setOptions:function(){var t=JSON.parse(localStorage.getItem("options"));this.$set(this,"options",Object(b["a"])(Object(b["a"])({},this.options),t))},reset:function(){this.bookList=[],this.$emit("reset")},listenFile:function(){var t=this;document.querySelector("#fileSelect input").addEventListener("change",(function(e){t.reset(),t.$nextTick((function(){var i=e.target.files[0],n=i.name.split(".").pop().toLowerCase(),o=new FileReader;o.onload=function(){if("txt"===n){t.bookList=O(o.result);try{var e=t.bookList[0];t.options.book=e.title,t.updateData(e)}catch(s){}}if("html"===n){var i=k(o.result);t.updateData(i)}},o.readAsText(i)}))}))},updateData:function(t){var e=t.title,i=t.texts;this.options.title=e,this.$emit("list-update",i),i.length?this.parse():this.$message.warning("未发现有效内容")},updateOptions:function(){var t=this.options,e=t.noTag,i=t.api,n=t.tag,o=t.split,s=t.tagPosition,a=t.reverse,r={noTag:e,api:i,tag:n,split:o,tagPosition:s,reverse:a};localStorage.setItem("options",JSON.stringify(r))},computedTag:function(){var t="",e=this.options,i=e.tag,n=e.title,o=e.noTag;if(o)return this.$emit("update-tag",t),this.tag=t,!1;t=i?"#".concat(i,"/").concat(n):"#".concat(n),this.$emit("update-tag",t),this.tag=t}}},E=M,S=(i("d5fc"),Object(p["a"])(E,m,g,!1,null,"1c73aad4",null)),P=S.exports,j=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"selected-text radio flex"},[i("div",[t._v(" 已选择 "),i("span",{staticClass:"highlight"},[t._v(t._s(t.selected))]),t._v(" 条 MEMO，共 "),i("span",{staticClass:"highlight"},[t._v(t._s(t.total))]),t._v(" 条（每天通过 API 最多发布 100 条 MEMO） "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[i("div",{staticStyle:{width:"200px"},attrs:{slot:"content"},slot:"content"},[t._v(" tip：未经审视的生活不值得过，未经审视的思想也不应该汇入你的大脑。所以在导入前审视一遍内容，手动选择需要导入的内容。 ")]),i("i",{staticClass:"el-icon-info"})]),i("a",{staticClass:"thanks",attrs:{href:"https://mp.weixin.qq.com/s/o793lUsBaWc61fLZzFDlxg",target:"_blank"}},[t._v(" 感谢 LP 的授权 ")])],1),i("div",[i("el-dropdown",[i("span",[t._v(" 关于作者 ")]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[i("a",{attrs:{href:"https://evolly.one",target:"_blank"}},[t._v("博客")])]),i("el-dropdown-item",[i("a",{attrs:{href:"https://album.animalcrossing.life",target:"_blank"}},[t._v("Tit1e's Photo Studio")])]),i("el-dropdown-item",[i("a",{attrs:{href:"https://personal-1251959693.cos.ap-chengdu.myqcloud.com/2021-05-23-IMG_8849.PNG",target:"_blank"}},[i("img",{attrs:{src:"https://personal-1251959693.cos.ap-chengdu.myqcloud.com/2021-05-23-IMG_8849.PNG",width:"200px",alt:"即刻"}})])])],1)],1)],1)])},I=[],D=(i("a9e3"),{name:"SelectedText",props:{selected:{type:Number,default:0},total:{type:Number,default:0}}}),N=D,q=(i("d911"),Object(p["a"])(N,j,I,!1,null,"62bfcdea",null)),J=q.exports,z=i("b76a"),A=i.n(z),F={name:"app",components:{ContentCard:h,Options:P,SelectedText:J,draggable:A.a},filters:{},data:function(){return{contentList:[],tmpList:[],index:0,loading:!1,tag:"",drag:!1,dragOptions:{animation:200}}},computed:{dragDisabled:function(){return!!this.contentList.filter((function(t){return t.isEdit})).length},disabled:function(){return this.checkedMemo.length>=100},checkedMemo:function(){return this.contentList.filter((function(t){return t.checked}))},loadingText:function(){return"为减轻服务器压力，导入间隔为 1s。导入进度： ".concat(this.index+1,"/").concat(this.checkedMemo.length)}},methods:{updateTag:function(t){this.tag=t},listUpdate:function(t){this.tmpList=t},sendMemo:function(t,e,i){var n=this,o={content:e[i].text};r.a.post(t,o).then((function(o){i<e.length-1?setTimeout((function(){n.index+=1,n.sendMemo(t,e,n.index)}),1e3):(n.$message.success("导入完毕"),n.loading=!1)})).catch((function(t){n.loading=!1,console.error(t),n.$message.error("记录失败")}))},submit:function(t){this.loading=!0,this.index=0,this.sendMemo(t,this.checkedMemo,this.index)},confirmCanEdit:function(t){var e=this,i=localStorage.getItem("canEdit")||"0";"0"===i&&this.$alert("双击 MEMO 可进入编辑模式","提示",{confirmButtonText:"知道了，不再提示",callback:function(i){localStorage.setItem("canEdit","1"),e.parse(t)}})},confirmFirstParse:function(t){var e=this,i=localStorage.getItem("hasConfirm")||"0";"0"===i?this.$alert("每次修改“书名”、“Tag”、“Tag 位置”、“分隔符”后需重新解析才会生效，重新解析会还原编辑后的内容。","提示",{confirmButtonText:"知道了，不再提示",callback:function(i){localStorage.setItem("hasConfirm","1"),e.parse(t)}}):this.parse(t)},parse:function(t){var e=this,i=t.split,n=t.tagPosition;this.contentList=[],this.$nextTick((function(){e.contentList=JSON.parse(JSON.stringify(e.tmpList)).map((function(t){var o="";return o=i?"".concat(t.text,"\r\n\r\n").concat(i):t.text,o=n?"".concat(e.tag,"\r\n\r\n").concat(o):"".concat(o,"\r\n\r\n").concat(e.tag),t.text=o,t})),e.confirmCanEdit(t)}))},reverseList:function(){this.contentList.reverse()},reset:function(){this.contentList=[],this.tmpList=[]}}},G=F,B=(i("abb8"),Object(p["a"])(G,o,s,!1,null,null,null)),U=B.exports,H=i("5c96"),K=i.n(H);i("0fae");n["default"].use(K.a);i("3cd6"),i("9536");n["default"].config.productionTip=!1,new n["default"]({render:function(t){return t(U)}}).$mount("#app")},9536:function(t,e,i){},abb8:function(t,e,i){"use strict";i("56d1")},d5fc:function(t,e,i){"use strict";i("3ae5")},d911:function(t,e,i){"use strict";i("0eb6")},daba:function(t,e,i){"use strict";i("e4ca")},e4ca:function(t,e,i){}});
//# sourceMappingURL=app.c318ac77.js.map